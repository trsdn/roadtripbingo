<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Non-Square Test Icons</title>
</head>
<body>
    <h1>Adding Non-Square Test Icons</h1>
    <p>This will add DD.png and WOB.png (non-square icons) to the application for testing...</p>
    <div id="status">Loading...</div>

    <script src="db.js"></script>
    <script>
        async function addTestIcons() {
            try {
                // Initialize the storage
                await window.iconDB.init();
                
                // Function to convert image to base64
                function imageToBase64(imagePath) {
                    return new Promise((resolve, reject) => {
                        const img = new Image();
                        img.crossOrigin = 'anonymous';
                        img.onload = function() {
                            const canvas = document.createElement('canvas');
                            const ctx = canvas.getContext('2d');
                            canvas.width = img.width;
                            canvas.height = img.height;
                            ctx.drawImage(img, 0, 0);
                            const dataURL = canvas.toDataURL('image/png');
                            resolve(dataURL);
                        };
                        img.onerror = reject;
                        img.src = imagePath;
                    });
                }
                
                // Add the non-square icons
                const dd = await imageToBase64('icons/DD.png');
                const wob = await imageToBase64('icons/WOB.png');
                
                const testIcons = [
                    {
                        id: 'test-dd-' + Date.now(),
                        name: 'DD.png',
                        data: dd
                    },
                    {
                        id: 'test-wob-' + Date.now(),
                        name: 'WOB.png', 
                        data: wob
                    }
                ];
                
                // Load existing icons and add new ones
                const existingIcons = await window.iconDB.loadIcons();
                const allIcons = [...existingIcons, ...testIcons];
                
                await window.iconDB.saveIcons(allIcons);
                
                document.getElementById('status').innerHTML = `
                    <p style="color: green;">✅ Successfully added ${testIcons.length} non-square test icons!</p>
                    <p>Total icons now: ${allIcons.length}</p>
                    <p><a href="index.html">Go to main application to test →</a></p>
                `;
                
            } catch (error) {
                console.error('Error adding test icons:', error);
                document.getElementById('status').innerHTML = `
                    <p style="color: red;">❌ Error adding test icons: ${error.message}</p>
                `;
            }
        }
        
        // Run when page loads
        addTestIcons();
    </script>
</body>
</html>
