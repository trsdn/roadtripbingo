// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Icon {
  id                    String   @id @default(cuid())
  name                  String
  nameDE                String   @default("") // German translation (legacy - kept for compatibility)
  translations          String   @default("{}") // JSON object with language codes as keys
  data                  String   // Base64 encoded image data
  difficulty            Int      @default(1)
  tags                  String   @default("[]") // JSON string
  excludeFromMultiHit   Boolean  @default(false)
  altText               String   @default("")
  category              String   @default("default")
  createdAt             DateTime @default(now())
  updatedAt             DateTime @updatedAt
  
  generations CardGeneration[]
  iconSets    IconSetIcon[]
  
  @@index([excludeFromMultiHit])
}

model Setting {
  id        String   @id @default(cuid())
  key       String   @unique
  value     String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model CardGeneration {
  id        String   @id @default(cuid())
  title     String
  gridSize  Int
  settings  String   // JSON string
  cards     String   // JSON string
  createdAt DateTime @default(now())
  
  icons     Icon[]
}

model IconSet {
  id          String   @id @default(cuid())
  name        String
  description String   @default("")
  color       String   @default("#3B82F6") // Default blue color
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  icons       IconSetIcon[]
  
  @@index([name])
}

model IconSetIcon {
  id         String   @id @default(cuid())
  iconSetId  String
  iconId     String
  order      Int      @default(0)
  createdAt  DateTime @default(now())
  
  iconSet    IconSet  @relation(fields: [iconSetId], references: [id], onDelete: Cascade)
  icon       Icon     @relation(fields: [iconId], references: [id], onDelete: Cascade)
  
  @@unique([iconSetId, iconId])
  @@index([iconSetId])
  @@index([iconId])
}